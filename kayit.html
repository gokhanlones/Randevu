<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kayıt Ol</title>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
:root {
    --primary: #4F46E5;
    --primary-hover: #4338CA;
    --light-bg: #F3F4F6;
    --card-bg: #FFFFFF;
    --text-dark: #1F2937;
    --border: #E5E7EB;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
    font-family:'Segoe UI', sans-serif;
    background:var(--light-bg);
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.container {
    width:100%;
    max-width:420px;
    padding:20px;
}

.card {
    background:var(--card-bg);
    padding:40px 35px;
    border-radius:14px;
    box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

.card h2 {
    text-align:center;
    margin-bottom:25px;
    color:var(--text-dark);
}

.input-group {
    margin-bottom:16px;
}

.input-group input {
    width:100%;
    padding:13px;
    border-radius:8px;
    border:1px solid var(--border);
    font-size:14px;
}

.input-group input:focus {
    outline:none;
    border-color:var(--primary);
    box-shadow:0 0 0 2px rgba(79,70,229,0.15);
}

.save-btn {
    width:100%;
    padding:13px;
    border:none;
    border-radius:8px;
    background:var(--primary);
    color:white;
    font-size:15px;
    font-weight:500;
    cursor:pointer;
    transition:0.2s ease;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:8px;
}

.save-btn:hover {
    background:var(--primary-hover);
}

.save-btn.loading {
    opacity:0.7;
    pointer-events:none;
}

.back {
    text-align:center;
    margin-top:20px;
    font-size:14px;
}

.back a {
    color:var(--primary);
    text-decoration:none;
}

#result {
    margin-top:15px;
    padding:12px;
    border-radius:8px;
    text-align:center;
    display:none;
    font-size:14px;
}

.success {
    background:#d1fae5;
    color:#065f46;
    border:1px solid #a7f3d0;
}

.error {
    background:#fee2e2;
    color:#991b1b;
    border:1px solid #fecaca;
}
</style>
</head>

<body>

<div class="container">
<div class="card">

<h2>Kayıt Ol</h2>

<!-- Gizli iframe - form submit için -->
<iframe name="hiddenFrame" id="hiddenFrame" style="display:none;"></iframe>

<!-- FORM - CORS yok, direkt submit -->
<form id="registerForm" 
      action="https://script.google.com/macros/s/AKfycbzl4infJ2Wn7nUBrZpbvjhhqPHDToppLNGIAX1KxqD_sD1sKpJIJncufqWO28OSpIwILg/exec" 
      method="POST" 
      target="hiddenFrame">

    <input type="hidden" name="action" value="sendVerification">
    
    <div class="input-group">
        <input type="text" name="firstName" id="firstName" placeholder="Ad" required>
    </div>

    <div class="input-group">
        <input type="text" name="lastName" id="lastName" placeholder="Soyad" required>
    </div>

    <div class="input-group">
        <input type="email" name="email" id="email" placeholder="Email" required>
    </div>

    <div class="input-group">
        <input type="email" id="email2" placeholder="Email Tekrar" required>
    </div>

    <div class="input-group">
        <input type="tel" name="phone" id="phone" placeholder="Telefon (05xxxxxxxxx)" required>
    </div>

    <button type="submit" class="save-btn" id="registerBtn">
        <i class="fa-solid fa-user-plus"></i> Kaydet
    </button>

</form>

<div id="result"></div>

<div class="back">
    <a href="index.html">Ana sayfaya dön</a>
</div>

</div>
</div>

<script>
document.getElementById('registerForm').addEventListener('submit', function(e) {
    const email = document.getElementById('email').value.trim();
    const email2 = document.getElementById('email2').value.trim();
    const phone = document.getElementById('phone').value.trim();
    
    // Validasyon
    if (email !== email2) {
        e.preventDefault();
        showResult('Email adresleri eşleşmiyor!', 'error');
        return false;
    }
    
    if (!/^05\d{9}$/.test(phone.replace(/\s/g,''))) {
        e.preventDefault();
        showResult('Telefon 05xxxxxxxxx formatında olmalı!', 'error');
        return false;
    }
    
    // Buton loading yap
    const btn = document.getElementById("registerBtn");
    btn.classList.add("loading");
    btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Gönderiliyor...`;
    
    // Form submit edilecek (iframe'e) - CORS yok!
    
    // 3 saniye sonra başarılı mesaj
    setTimeout(function() {
        showResult('✅ Doğrulama maili gönderildi! Lütfen mailinizi kontrol edin.', 'success');
        
        // 2 saniye sonra ana sayfaya yönlendir
        setTimeout(() => {
            window.location.href = "index.html";
        }, 2000);
        
    }, 3000);
});

function showResult(msg, type) {
    const div = document.getElementById('result');
    div.textContent = msg;
    div.className = type;
    div.style.display = 'block';
    
    // Butonu normale döndür
    const btn = document.getElementById("registerBtn");
    btn.classList.remove("loading");
    btn.innerHTML = `<i class="fa-solid fa-user-plus"></i> Kaydet`;
}
</script>

</body>
</html>
