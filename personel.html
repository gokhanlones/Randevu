<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personel - Stilix</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',sans-serif;background:#f5f5f5;}

.navbar{
height:60px;
background:linear-gradient(135deg,#667eea,#764ba2);
display:flex;
align-items:center;
padding:0 20px;
color:#fff;
font-weight:600;
}

.main{padding:25px;display:flex;justify-content:center;}
.container{width:100%;max-width:900px;}

.card{
background:#fff;
border-radius:20px;
padding:25px;
box-shadow:0 8px 25px rgba(0,0,0,0.06);
margin-bottom:20px;
}

.card h3{margin-bottom:20px;}

.input-group{margin-bottom:15px;}
.input-group label{display:block;font-size:0.9rem;margin-bottom:5px;}
.input-group input{
width:100%;
padding:10px;
border-radius:10px;
border:2px solid #ddd;
outline:none;
}
.input-group input:focus{border-color:#667eea;}

.grid2{
display:grid;
grid-template-columns:1fr 1fr;
gap:15px;
}

.services-list{
max-height:220px;
overflow-y:auto;
border:1px solid #eee;
padding:15px;
border-radius:12px;
margin-bottom:20px;
}

.service-item{
display:flex;
align-items:center;
margin-bottom:8px;
font-size:0.9rem;
}

.service-item input{margin-right:8px;}

.days{
display:flex;
flex-wrap:wrap;
gap:8px;
margin-bottom:15px;
}

.day-btn{
padding:8px 12px;
border-radius:8px;
border:1px solid #ddd;
cursor:pointer;
font-size:0.85rem;
background:#fff;
}

.day-btn.active{
background:#667eea;
color:#fff;
border-color:#667eea;
}

.time-grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:15px;
}

.time-grid input{
width:100%;
padding:10px;
border-radius:10px;
border:2px solid #ddd;
}

.save-btn{
margin-top:20px;
width:100%;
padding:16px;
border:none;
border-radius:14px;
background:linear-gradient(135deg,#4caf50,#66bb6a);
color:#fff;
font-weight:700;
font-size:1rem;
cursor:pointer;
}
</style>
</head>

<body>

<div class="navbar">
Personel Yönetimi
</div>

<div class="main">
<div class="container">

<div class="card">
<h3>Personel Ekle</h3>

<div class="grid2">
<div class="input-group">
<label>Adı</label>
<input type="text" id="ad">
</div>

<div class="input-group">
<label>Soyadı</label>
<input type="text" id="soyad">
</div>
</div>

<h4 style="margin:20px 0 10px 0;">Hizmetler</h4>
<div class="services-list" id="servicesContainer">
Yükleniyor...
</div>

<h4 style="margin:20px 0 10px 0;">Çalışma Günleri</h4>

<div class="days">
<div class="day-btn">Pzt</div>
<div class="day-btn">Sal</div>
<div class="day-btn">Çar</div>
<div class="day-btn">Per</div>
<div class="day-btn">Cum</div>
<div class="day-btn">Cmt</div>
<div class="day-btn">Paz</div>
</div>

<h4 style="margin:20px 0 10px 0;">Çalışma Saatleri</h4>

<div class="time-grid">
<div>
<label>Başlangıç</label>
<input type="time">
</div>
<div>
<label>Bitiş</label>
<input type="time">
</div>
<div>
<label>Öğle Başlangıç</label>
<input type="time">
</div>
<div>
<label>Öğle Bitiş</label>
<input type="time">
</div>
</div>

<button class="save-btn">Kaydet</button>

</div>

</div>
</div>

<script>

const API = "https://script.google.com/macros/s/AKfycbzYUCYSIhlgQ-GeFFpukJNUC8nqrF3tZQd3LJfZvH0QLY0pSiAqbjhE5-I4sjJbmV9M/exec";

function jsonp(action,params={}){
return new Promise((resolve, reject)=>{
const cb="cb_"+Date.now();
window[cb]=d=>{
delete window[cb];
document.body.removeChild(s);
resolve(d);
};
const q=new URLSearchParams({action,callback:cb,...params}).toString();
const s=document.createElement("script");
s.src=API+"?"+q;
s.onerror=()=>reject();
document.body.appendChild(s);
});
}

async function loadSubeServices(){

const subeId = localStorage.getItem("selectedBranch");
const token = localStorage.getItem("stilix_token");

if(!subeId || !token){
document.getElementById("servicesContainer").innerHTML = "Şube bulunamadı";
return;
}

const res = await jsonp("getSubeServices",{
token: token,
subeId: subeId
});

if(!res.success || !res.services){
document.getElementById("servicesContainer").innerHTML = "Hizmet bulunamadı";
return;
}

const container = document.getElementById("servicesContainer");
container.innerHTML = "";

res.services.forEach(service=>{
const div = document.createElement("div");
div.className = "service-item";
res.services.forEach(service=>{

if (!service.hizmet || service.hizmet.trim() === '') return;

const div = document.createElement("div");
div.className = "service-item";
div.innerHTML = `
<input type="checkbox" value="${service.hizmetId}">
${service.hizmet}
`;
container.appendChild(div);

});

}

document.addEventListener("DOMContentLoaded",()=>{
loadSubeServices();

document.querySelectorAll(".day-btn").forEach(btn=>{
btn.addEventListener("click",()=>{
btn.classList.toggle("active");
});
});
});

</script>

</body>
</html>
